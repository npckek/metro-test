# Backend — Metro API (FastAPI + PostgreSQL)

RESTful API для обработки, хранения и предоставления точных геокоординат и статистики станций метро.  
Система поддерживает авторизацию, роли, автоматическую загрузку данных и создание суперпользователя.

### Основные возможности

- Полноценный API станций метро
- Хранение подробных данных: координаты, тип транспорта, статистика входов/выходов
- Авторизация на основе JWT (cookie-based)
- Роли: суперпользователь / обычный пользователь
- Автоматическая загрузка GeoJSON-данных при первом запуске
- Автоматическое создание суперпользователя
- PostgreSQL в Docker, миграции через SQLAlchemy

### Стек технологий

- **Python 3.11**
- **FastAPI 0.110**
- **SQLAlchemy 2.0**
- **PostgreSQL**
- **Uvicorn**
- **Pydantic v2**
- **python-jose**
- **bcrypt + passlib**
- **Docker / Docker Compose**

## Запуск через Docker
### Создание секретов
Создайте файл .env и задайте необходимые переменные:
```bash
cp .env.example .env
```

### Запуск
Требуется Docker и Docker Compose.
```bash
docker compose up --build
```

## API Роуты
Авторизация (/api/v1/auth):

- POST /token — вход, создание JWT, установка cookie
- POST /logout — выход
- Post /status - проверка статуса аутентификации


Станции (/api/v1/stations)

- GET / — список станций
- GET /{id} — детальная информация о станции
- POST / — создание новой станции (только суперпользователь)
- PUT /{id} - обновление данных о стацнии (только для суперпользователя)
- DELETE /{id} — удаление станции (только суперпользователь)